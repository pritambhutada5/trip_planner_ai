services:
  #---------------- Backend Service (FastAPI) ----------------#
  - type: web
    name: trip-planner-backend
    env: docker
    repo: https://github.com/pritambhutada5/trip_planner_ai.git
    # The start command that runs inside the container
    startCommand: ./start.sh
    healthCheckPath: /health
    envVars:
      - key: GEMINI_API_KEY
        sync: false # Mark as a secret that you will set in the dashboard

  #---------------- Frontend Service (Streamlit) ----------------#
  - type: web
    name: trip-planner-frontend
    env: docker
    repo: https://github.com/pritambhutada5/trip_planner_ai.git
    # The start command that runs inside the container
    startCommand: streamlit run streamlit_app.py --server.port $PORT --server.address 0.0.0.0
    envVars:
      - key: API_URL
        # This powerful feature automatically gets the URL of your backend service
        fromService:
          type: web
          name: trip-planner-backend
          property: url
      # Important: We must also add the path to the endpoint
      - key: API_ENDPOINT_PATH
        value: /api/plan-full-trip
